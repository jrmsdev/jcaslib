language: c

sudo: false

branches:
    only:
        - master

dist: trusty

compiler:
    - gcc
    - clang

addons:
    apt:
        packages:
            - libgdbm-dev
            - bmake

matrix:
    include:
        - os: osx
          addons:
          compiler: gcc

before_script:
    - ./configure --use-gdbm
    - bmake depend
    - bmake -j2
    - bmake examples
    - bmake dist

script:
    - ./build/lib/libjc.so
    - bmake check
